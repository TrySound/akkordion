/*!
 * akkordion 0.1.1
 * Accordion UI Element
 * https://github.com/TrySound/akkordion
 * 
 * Released under the MIT license
 * Copyright (c) 2015, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(t){window.akkordion=t(window,document)}(function(t,e,n){function o(t,e){var n=this;n.root=t,n.options=f({},e,c(t)),n.cache(),n.setDefaultState(),n.bindEvents(),s("init",n)}function r(t,n){var r,n=f({},h,n);for("string"==typeof t&&(t=e.querySelectorAll(t)),i=0,max=t.length;i<max;i++)r=t[i],l(r,y)||(l(r,y,!0),new o(r,n))}function s(t,e,n){var o,i,r=d[t],s=e.root,a=e.titleSet[n],l=e.contentSet[n],u=!0;for(o=0,i=r.length;i>o;o++)u=r[o].call(s,a,l)===!1?!1:u;return u}function a(t,e,n){n=n?!0:null,l(t.titleSet[e],m,n),l(t.outerSet[e],m,n),l(t.contentSet[e],m,n)}function l(t,e,o){return e="data-"+p+"-"+e,o===n?t.hasAttribute(e):null===o?t.removeAttribute(e):t.setAttribute(e,o)}function u(t,e,n){t.addEventListener(e,n,!1)}function f(){var t,e,o,i,r=arguments[0]||{};for(t=1,e=arguments.length;e>t;t++)if(o=arguments[t],null!=o)for(i in o)o.hasOwnProperty(i)&&o[i]!==n&&(r[i]=o[i]);return r}function c(t){var e,n,o,i=t.attributes,r="data-"+p+"-",s={};for(e=i.length;e--;)n=i[e].name,o=i[e].value,0===n.indexOf(r)&&(s[n.substring(r.length)]="true"===o?!0:"false"===o?!1:isNaN(o)?o:Number(o));return s}var h={single:!0,speed:300,hover:!1},d={init:[],abort:[],beforeopen:[],open:[],afteropen:[],beforeclose:[],close:[],afterclose:[]},p="akkordion",g=!1,v=!1,m="active",b="animating",y="initialized";return function(){var t=e.createElement("div");t.style.WebkitTransition!==n&&(g="-webkit-transition",v="webkitTransitionEnd"),t.style.transition!==n&&(g="transition",v="transitionend")}(),o.prototype={cache:function(){var t,n,o,i,r=this,s=r.root,a=s.querySelectorAll("."+p+"-title"),l=e.createElement("div"),u=[],f=[],c=[];for(l.className=p+"-outer",t=a.length-1;t>-1;t--)(n=a[t]).parentNode===s&&(o=(o=n.nextSibling)?1===o.nodeType?o:(o=o.nextSibling)&&1===o.nodeType?o:null:null,o=o&&o.className.indexOf(p+"-content")>-1?o:null,o&&(u.unshift(n),i=l.cloneNode(),i.appendChild(s.replaceChild(i,o)),c.unshift(i),f.unshift(o)));r.titleSet=u,r.outerSet=c,r.contentSet=f},setDefaultState:function(){var t,e=this,n=e.outerSet,o=e.contentSet;for(t=n.length-1;t>-1;t--)o[t].style.height="auto",o[t].className.indexOf(p+"-active")>-1&&(a(e,t,!0),n[t].style.height="auto")},bindEvents:function(){function t(t){var e,o=t.target,i=n.titleSet,r=i.indexOf(o);if(o.className.indexOf(p+"-title")>-1&&t.preventDefault(),r>-1)if(l(o,m))n.close(r);else if(n.open(r),n.options.single)for(e=i.length-1;e>-1;e--)e!==r&&n.close(e)}var e,n=this;u(n.root,"mouseover",function(o){var i=n.options.hover;i!==!1&&(e=setTimeout(function(){t(o)},i))}),u(n.root,"mouseout",function(){clearTimeout(e)}),u(n.root,"click",t),u(n.root,v,function(t){var e,o=t.target;"height"===t.propertyName&&(e=n.outerSet.indexOf(o))>-1&&(l(o,b,null),l(o,m)?(o.style.cssText="height:auto;",s("afteropen",n,e)):(o.style.cssText="",s("afterclose",n,e)))})},open:function(t,e){var n,o=this,i=o.outerSet[t],r=(o.contentSet[t],o.options),u=r.speed;if(!g||e||0===u){if(!s("beforeopen",o,t))return void s("abort",o,t);a(o,t,!0),i.style.cssText="height:auto;",s("open",o,t),s("afteropen",o,t)}else if(!l(i,b)&&!l(i,m)){if(!s("beforeopen",o,t))return void s("abort",o,t);a(o,t,!0),l(i,b,!0),i.style.height="auto",n=getComputedStyle(i).height,i.style.height=0,i.offsetWidth,i.style.cssText="height:"+n+";"+g+"-duration:"+u+"ms;",s("open",o,t)}},close:function(t,e){var n=this,o=n.outerSet[t],i=(n.contentSet[t],n.options),r=i.speed;if(!g||e||0===r){if(!s("beforeclose",n,t))return void s("abort",n,t);a(n,t,!1),o.style.cssText="",s("close",n,t),s("afterclose",n,t)}else if(!l(o,b)&&l(o,m)){if(!s("beforeclose",n,t))return void s("abort",n,t);a(n,t,!1),l(o,b,!0),o.style.height=getComputedStyle(o).height,o.offsetHeight,o.style.cssText=g+"-duration:"+r+"ms;",s("close",n,t)}}},r.on=function(t,e){var n=d[t=t.toLowerCase()];return n&&"function"==typeof e&&n.push(e),r},u(e,"DOMContentLoaded",function(){r("."+p)}),r});
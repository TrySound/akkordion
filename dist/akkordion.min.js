/*!
 * akkordion 0.2.3
 * Accordion UI Element
 * https://github.com/TrySound/akkordion
 * 
 * Released under the MIT license
 * Copyright (c) 2015, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(e){window.akkordion=e(window,document)}(function(e,t,n){function o(e,t){var n=this;n.root=e,n.options=c({},t,h(e)),n.cache(),n.setDefaultState(),n.bindEvents(),s("init",n)}function r(e,n){var r,n=c({},d,n);for("string"==typeof e&&(e=t.querySelectorAll(e)),i=0,max=e.length;i<max;i++)r=e[i],a(r,y)||(a(r,y,!0),x.push(new o(r,n)))}function u(e,t,n,o){var r,u;if(e)for(i=x.length-1;i>-1;i--)if(x[i].root===e)return r=x[i],Number.isInteger(t)||((u=r.titleSet.indexOf(t)>-1)?t=u:(u=r.contentSet.indexOf(t)>-1)&&(t=u)),r[o](Number(t),n)!==!1}function s(e,t,n){var o,i,r=p[e],u=t.root,s=t.titleSet[n],l=t.contentSet[n],a=!0;for(o=0,i=r.length;i>o;o++)a=r[o].call(u,s,l)===!1?!1:a;return a}function l(e,t,n){n=n?!0:null,a(e.titleSet[t],S,n),a(e.outerSet[t],S,n),a(e.contentSet[t],S,n)}function a(e,t,o){return t="data-"+g+"-"+t,o===n?e.hasAttribute(t):null===o?e.removeAttribute(t):e.setAttribute(t,o)}function f(e,t,n){e.addEventListener(t,n,!1)}function c(){var e,t,o,i,r=arguments[0]||{};for(e=1,t=arguments.length;t>e;e++)if(o=arguments[e],null!=o)for(i in o)o.hasOwnProperty(i)&&o[i]!==n&&(r[i]=o[i]);return r}function h(e){var t,n,o,i=e.attributes,r="data-"+g+"-",u={};for(t=i.length;t--;)n=i[t].name,o=i[t].value,0===n.indexOf(r)&&(u[n.substring(r.length)]="true"===o?!0:"false"===o?!1:isNaN(o)?o:Number(o));return u}var d={single:!0,speed:350,hover:!1},p={init:[],abort:[],beforeopen:[],open:[],afteropen:[],beforeclose:[],close:[],afterclose:[]},g="akkordion",v=!1,m=!1,S="active",b="animating",y="initialized";!function(){var e=t.createElement("div");e.style.transition!==n&&(v="transition",m="transitionend")}(),o.prototype={cache:function(){var e,n,o,i,r=this,u=r.root,s=u.querySelectorAll("."+g+"-title"),l=t.createElement("div"),a=[],f=[],c=[];for(l.className=g+"-outer",e=s.length-1;e>-1;e--)(n=s[e]).parentNode===u&&(o=(o=n.nextSibling)?1===o.nodeType?o:(o=o.nextSibling)&&1===o.nodeType?o:null:null,o=o&&o.className.indexOf(g+"-content")>-1?o:null,o&&(a.unshift(n),i=l.cloneNode(),i.appendChild(u.replaceChild(i,o)),c.unshift(i),f.unshift(o)));r.titleSet=a,r.outerSet=c,r.contentSet=f},setDefaultState:function(){var e,t=this,n=t.outerSet,o=t.contentSet;for(e=n.length-1;e>-1;e--)o[e].style.height="auto",o[e].className.indexOf(g+"-active")>-1&&(l(t,e,!0),n[e].style.height="auto")},bindEvents:function(){function e(e){for(var t,i=n.titleSet,r=e.target,u=r;o!==u&&!((t=i.indexOf(u))>-1);)u=u.parentNode;t>-1&&(a(u,S)?n.close(t):n.open(t),e.preventDefault())}var t,n=this,o=n.root;f(o,"mouseover",function(o){var i=n.options.hover;i!==!1&&(t=setTimeout(function(){e(o)},i))}),f(o,"mouseout",function(){clearTimeout(t)}),f(o,"click",e),f(o,m,function(e){var t,o=e.target;"height"===e.propertyName&&(t=n.outerSet.indexOf(o))>-1&&(a(o,b,null),a(o,S)?(o.style.cssText="height:auto;",s("afteropen",n,t)):(o.style.cssText="",s("afterclose",n,t)))})},open:function(e,t){var n,o,i,r=this,u=r.outerSet,f=r.options,c=f.speed;if(e=-1===e?u.length-1:e,i=u[e],!i)return!1;if(f.single)for(o=u.length-1;o>-1;o--)o!==e&&r.close(o,t);if(!v||t||0===c){if(!s("beforeopen",r,e))return void s("abort",r,e);l(r,e,!0),i.style.cssText="height:auto;",s("open",r,e),s("afteropen",r,e)}else if(!a(i,b)&&!a(i,S)){if(!s("beforeopen",r,e))return void s("abort",r,e);l(r,e,!0),a(i,b,!0),i.style.height="auto",n=getComputedStyle(i).height,i.style.height=0,i.offsetWidth,i.style.cssText="height:"+n+";"+v+"-duration:"+c+"ms;",s("open",r,e)}},close:function(e,t){var n=this,o=n.outerSet,i=n.options.speed;if(e=-1===e?o.length-1:e,outer=o[e],!outer)return!1;if(!v||t||0===i){if(!s("beforeclose",n,e))return void s("abort",n,e);l(n,e,!1),outer.style.cssText="",s("close",n,e),s("afterclose",n,e)}else if(!a(outer,b)&&a(outer,S)){if(!s("beforeclose",n,e))return void s("abort",n,e);l(n,e,!1),a(outer,b,!0),outer.style.height=getComputedStyle(outer).height,outer.offsetHeight,outer.style.cssText=v+"-duration:"+i+"ms;",s("close",n,e)}}};var x=[];return r.on=function(e,t){var n=p[e=e.toLowerCase()];return n&&"function"==typeof t&&n.push(t),r},r.open=function(e,t,n){u(e,t,n,"open")},r.close=function(e,t,n){u(e,t,n,"close")},f(t,"DOMContentLoaded",function(){r("."+g)}),r});
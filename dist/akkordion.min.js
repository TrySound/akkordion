/*!
 * akkordion 0.0.2
 * Accordion UI Element
 * https://github.com/TrySound/akkordion
 * 
 * Released under the MIT license
 * Copyright (c) 2015, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(t){window.akkordion=t(window,document)}(function(t,e,n){function o(t,e){this.root=t,this.options=h({},e,l(t,d)),this.cache(),this.setDefaultState(),this.bindEvents()}function s(t,n){var s,n=h({},m,n);for("string"==typeof t&&(t=e.querySelectorAll(t)),i=0,max=t.length;i<max;i++)s=t[i],r(s,S)||(r(s,S,!0),new o(s,n))}function r(t,e,i){return i===n?t.hasAttribute(e):null===i?t.removeAttribute(e):t.setAttribute(e,i)}function a(t,e,i){t.addEventListener(e,i,!1)}function h(){var t,e,i,n,o=arguments[0]||{};for(t=1,e=arguments.length;e>t;t++)if(i=arguments[t],null!=i)for(n in i)i.hasOwnProperty(n)&&"undefined"!=typeof i[n]&&(o[n]=i[n]);return o}function l(t,e){var i,n,o,s=t.attributes,r=e.length,a={};for(i=s.length;i--;)n=s[i].name,o=s[i].value,n.indexOf(e)>-1&&(a[n.substring(r)]="true"===o?!0:"false"===o?!1:0/0!==Number(o)?Number(o):o);return a}var u=!1,c=!1,f=!1,d="data-akkordion-",p=d+"active",y=d+"animating",g=d+"index",S=d+"initialized";!function(){var t=e.createElement("div");t.style.WebkitTransform!==n&&(u="-webkit-transform"),t.style.transform!==n&&(u="transform"),t.style.WebkitTransition!==n&&(c="-webkit-transition",f="webkitTransitionEnd"),t.style.transition!==n&&(c="transition",f="transitionend")}();var m={single:!0,speed:300,opacity:!1};return o.prototype.cache=function(){var t,i,n,o,s=this.root,r=s.querySelectorAll(".akkordion-title"),a=e.createElement("div"),h=[],l=[],u=[];for(a.className="akkordion-outer",t=r.length-1;t>-1;t--)(i=r[t]).parentNode===this.root&&(n=(n=i.nextSibling)?1===n.nodeType?n:(n=n.nextSibling)&&1===n.nodeType?n:null:null,n=n&&n.className.indexOf("akkordion-content")>-1?n:null,n&&(h.unshift(i),o=a.cloneNode(),o.appendChild(s.replaceChild(o,n)),u.unshift(o),l.unshift(n)));this.titleSet=h,this.outerSet=u,this.contentSet=l},o.prototype.setDefaultState=function(){var t,e,i,n,o,s=this.titleSet,a=this.outerSet,h=this.contentSet,l=this.options.single;for(t=0,e=s.length;e>t;t++)r(i=s[t],g,t),r(n=a[t],g,t),(o=h[t]).style.height="auto",o.className.indexOf("akkordion-active")>-1&&(l&&!this.initSingle||!l)?(this.initSingle=!0,r(i,p,!0),r(n,p,!0),r(o,p,!0)):n.style.height=0},o.prototype.bindEvents=function(){var t=this;a(this.root,"click",function(t){t.target.className.indexOf("akkordion-title")>-1&&t.preventDefault()}),a(this.root,"click",function(e){var i,n=e.target,o=t.titleSet.indexOf(n);if(o>-1)if(r(n,p))t.close(o);else if(t.open(o),t.options.single)for(i=t.outerSet.length-1;i>-1;i--)i!==o&&t.close(i)}),a(this.root,f,function(e){var i,n=e.target,o=e.propertyName;"height"===o&&(i=t.outerSet.indexOf(n))>-1&&(r(n,y,null),n.style.cssText=r(n,p)?"height:auto;":"height:0;")})},o.prototype.setActive=function(t,e){e?(r(this.titleSet[t],p,!0),r(this.outerSet[t],p,!0),r(this.contentSet[t],p,!0)):(r(this.titleSet[t],p,null),r(this.outerSet[t],p,null),r(this.contentSet[t],p,null))},o.prototype.open=function(t,e){var i,n=(this.titleSet[t],this.outerSet[t]),o=this.contentSet[t],s=c+"-duration:"+this.options.speed+"ms;",a=c+"-delay:"+this.options.speed/2+"ms;",h=this.options.opacity;!c||e?(this.setActive(t,!0),n.style.cssText="height:auto;"):r(n,y)||r(n,p)||(this.setActive(t,!0),r(n,y,!0),n.style.height="auto",i=getComputedStyle(n).height,n.style.height=0,n.offsetWidth,n.style.cssText="height:"+i+";"+s,h&&(o.style.cssText="height:auto;opacity:0;",n.offsetWidth,o.style.cssText="height:auto;opacity:1;"+s+a))},o.prototype.close=function(t,e){var i=this.outerSet[t];content=this.contentSet[t],transitionDuration=c+"-duration:"+this.options.speed+"ms;",transitionDelay=c+"-delay:"+this.options.speed/3+"ms;",hasOpacity=this.options.opacity,!c||e?(this.setActive(t,!1),i.style.cssText="height:0;"):!r(i,y)&&r(i,p)&&(this.setActive(t,!1),r(i,y,!0),i.style.height=getComputedStyle(i).height,i.offsetHeight,i.style.cssText="height:0;"+transitionDuration+(hasOpacity?transitionDelay:""),hasOpacity&&(content.style.cssText="height:auto;opacity:1;",i.offsetWidth,content.style.cssText="height:auto;opacity:0;"+transitionDuration))},a(e,"DOMContentLoaded",function(){s(".akkordion")}),s});
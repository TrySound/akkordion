/*!
 * akkordion 0.1.1
 * Accordion UI Element
 * https://github.com/TrySound/akkordion
 * 
 * Released under the MIT license
 * Copyright (c) 2015, Bogdan Chadkin <trysound@yandex.ru>
 */
!function(t){window.akkordion=t(window,document)}(function(t,e,n){function o(t,e){var n=this;n.root=t,n.options=f({},e,c(t,v)),n.cache(),n.setDefaultState(),n.bindEvents(),s("init",n)}function r(t,n){var r,n=f({},h,n);for("string"==typeof t&&(t=e.querySelectorAll(t)),i=0,max=t.length;i<max;i++)r=t[i],l(r,m)||(l(r,m,!0),new o(r,n))}function s(t,e,n){var o,i,r=d[t],s=e.root,a=e.titleSet[n],l=e.contentSet[n],u=!0;for(o=0,i=r.length;i>o;o++)u=r[o].call(s,a,l)===!1?!1:u;return u}function a(t,e,n){n=n?!0:null,l(t.titleSet[e],b,n),l(t.outerSet[e],b,n),l(t.contentSet[e],b,n)}function l(t,e,o){return o===n?t.hasAttribute(e):null===o?t.removeAttribute(e):t.setAttribute(e,o)}function u(t,e,n){t.addEventListener(e,n,!1)}function f(){var t,e,o,i,r=arguments[0]||{};for(t=1,e=arguments.length;e>t;t++)if(o=arguments[t],null!=o)for(i in o)o.hasOwnProperty(i)&&o[i]!==n&&(r[i]=o[i]);return r}function c(t,e){var n,o,i,r=t.attributes,s=e.length,a={};for(n=r.length;n--;)o=r[n].name,i=r[n].value,o.indexOf(e)>-1&&(a[o.substring(s)]="true"===i?!0:"false"===i?!1:isNaN(i)?i:Number(i));return a}var h={single:!0,speed:300,opacity:!1},d={init:[],abort:[],beforeopen:[],open:[],afteropen:[],beforeclose:[],close:[],afterclose:[]},p="akkordion",g=!1,y=!1,v="data-"+p+"-",b=v+"active",S=v+"animating",m=v+"initialized";return function(){var t=e.createElement("div");t.style.WebkitTransition!==n&&(g="-webkit-transition",y="webkitTransitionEnd"),t.style.transition!==n&&(g="transition",y="transitionend")}(),o.prototype={cache:function(){var t,n,o,i,r=this,s=r.root,a=s.querySelectorAll("."+p+"-title"),l=e.createElement("div"),u=[],f=[],c=[];for(l.className=p+"-outer",t=a.length-1;t>-1;t--)(n=a[t]).parentNode===s&&(o=(o=n.nextSibling)?1===o.nodeType?o:(o=o.nextSibling)&&1===o.nodeType?o:null:null,o=o&&o.className.indexOf(p+"-content")>-1?o:null,o&&(u.unshift(n),i=l.cloneNode(),i.appendChild(s.replaceChild(i,o)),c.unshift(i),f.unshift(o)));r.titleSet=u,r.outerSet=c,r.contentSet=f},setDefaultState:function(){var t,e=this,n=e.outerSet,o=e.contentSet;for(t=n.length-1;t>-1;t--)o[t].style.height="auto",o[t].className.indexOf(p+"-active")>-1&&(a(e,t,!0),n[t].style.height="auto")},bindEvents:function(){var t=this;u(t.root,"click",function(e){var n,o=e.target,i=t.titleSet,r=i.indexOf(o);if(o.className.indexOf(p+"-title")>-1&&e.preventDefault(),r>-1)if(l(o,b))t.close(r);else if(t.open(r),t.options.single)for(n=i.length-1;n>-1;n--)n!==r&&t.close(n)}),u(t.root,y,function(e){var n,o=e.target;"height"===e.propertyName&&(n=t.outerSet.indexOf(o))>-1&&(l(o,S,null),l(o,b)?(o.style.cssText="height:auto;",s("open",t,n),s("afteropen",t,n)):(o.style.cssText="",s("close",t,n),s("afterclose",t,n)))})},open:function(t,e){var n,o=this,i=o.outerSet[t],r=o.contentSet[t],u=o.options,f=u.opacity?"height:auto;opacity:":!1,c=u.speed,h=g+"-duration:"+c+"ms;",d=g+"-delay:"+c/3+"ms;";if(!g||e||0===c){if(!s("beforeopen",o,t))return void s("abort",o,t);a(o,t,!0),i.style.cssText="height:auto;",s("open",o,t),s("afteropen",o,t)}else if(!l(i,S)&&!l(i,b)){if(!s("beforeopen",o,t))return void s("abort",o,t);a(o,t,!0),l(i,S,!0),i.style.height="auto",n=getComputedStyle(i).height,i.style.height=0,i.offsetWidth,i.style.cssText="height:"+n+";"+h,f&&(r.style.cssText=f+"0;",i.offsetWidth,r.style.cssText=f+"1;"+h+d)}},close:function(t,e){var n=this,o=n.outerSet[t],i=n.contentSet[t],r=n.options,u=r.opacity?"height:auto;opacity:":!1,f=r.speed,c=g+"-duration:"+f+"ms;",h=g+"-delay:"+f/3+"ms;";if(!g||e||0===f){if(!s("beforeclose",n,t))return void s("abort",n,t);a(n,t,!1),o.style.cssText="",s("close",n,t),s("afterclose",n,t)}else if(!l(o,S)&&l(o,b)){if(!s("beforeclose",n,t))return void s("abort",n,t);a(n,t,!1),l(o,S,!0),o.style.height=getComputedStyle(o).height,o.offsetHeight,o.style.cssText=c+(u?h:""),u&&(i.style.cssText=u+"1;",o.offsetWidth,i.style.cssText=u+"0;"+c)}}},r.on=function(t,e){var n=d[t=t.toLowerCase()];return n&&"function"==typeof e&&n.push(e),r},u(e,"DOMContentLoaded",function(){r("."+p)}),r});